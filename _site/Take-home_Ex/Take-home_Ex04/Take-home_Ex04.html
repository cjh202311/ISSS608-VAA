<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cai Jingheng">
<meta name="dcterms.date" content="2024-03-01">

<title>Visual Analytics - Take Home Exercise 4: Prototyping Modules for Visual Analytics Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Visual Analytics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-pencil-square" role="img">
</i> 
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex4A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex4B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex4C.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4C</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex4D.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4D</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05C.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5C</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05D.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5D</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05E.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5E</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07C.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8C</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-book-half" role="img">
</i> 
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex6.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex7.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex9.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-person-fill" role="img">
</i> 
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-project" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-people-fill" role="img">
</i> 
 <span class="menu-text">Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-project">    
        <li>
    <a class="dropdown-item" href="https://g1grp8-housingindexnowcast.netlify.app/" rel="" target="">
 <span class="dropdown-text">Group Project</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://public.tableau.com/app/profile/jingheng.cai/vizzes" rel="" target=""><i class="bi bi-bar-chart-fill" role="img">
</i> 
 <span class="menu-text">Tableau</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-house-door-fill" role="img">
</i> 
 <span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cjh202311" rel="" target=""><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jh.cai.2023@mitb.smu.edu.sg" rel="" target=""><i class="bi bi-envelope-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">1</span> <strong>Objectives</strong></a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">2</span> Data Preparation</a></li>
  <li><a href="#design-for-eda" id="toc-design-for-eda" class="nav-link" data-scroll-target="#design-for-eda"><span class="header-section-number">3</span> Design for EDA</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">3.1</span> Overview</a></li>
  <li><a href="#trend" id="toc-trend" class="nav-link" data-scroll-target="#trend"><span class="header-section-number">3.2</span> Trend</a></li>
  <li><a href="#distribution" id="toc-distribution" class="nav-link" data-scroll-target="#distribution"><span class="header-section-number">3.3</span> Distribution</a></li>
  <li><a href="#autocorrelation" id="toc-autocorrelation" class="nav-link" data-scroll-target="#autocorrelation"><span class="header-section-number">3.4</span> <strong>Autocorrelation</strong></a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">3.5</span> Correlation</a></li>
  </ul></li>
  <li><a href="#future-work" id="toc-future-work" class="nav-link" data-scroll-target="#future-work"><span class="header-section-number">4</span> Future Work</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take Home Exercise 4: Prototyping Modules for Visual Analytics Shiny Application</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cai Jingheng </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 1, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 11, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="objectives" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">1</span> <strong>Objectives</strong></h2>
<p>In this take-home exercise, we are required to select one of the modules of our proposed Shiny application and complete the following tasks:</p>
<ul>
<li><p>To evaluate and determine the necessary R packages needed for our Shiny application are supported in R CRAN,</p></li>
<li><p>To prepare and test the specific R codes to ensure they can be run and return the correct output as expected,</p></li>
<li><p>To determine the parameters and outputs that will be exposed on the Shiny applications, and</p></li>
<li><p>To select the appropriate Shiny UI components for exposing the parameters determined above.</p></li>
</ul>
</section>
<section id="data-preparation" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">2</span> Data Preparation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Load Files</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Data Wrangling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Join Tables</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Save Dataset</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Load Dataset</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/PPI_private_housing.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'PR_All'</span>, <span class="st">'PR_Landed'</span>, <span class="st">'PR_NL_ALL'</span>, <span class="st">'PR_NL_CCR'</span>, <span class="st">'PR_NL_RCR'</span>, <span class="st">'PR_NL_OCR'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Date) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>material_price <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Construction Materials prices.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Cement'</span>, <span class="st">'SteelBar'</span>, <span class="st">'Granite'</span>, <span class="st">'ConcretingSand'</span>, <span class="st">'ReadyMixConcrete'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Index FTSE Strait Times.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Index'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>tbillbond <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Treasury_Bill_Bond_ rates.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Bill1Yr'</span>, <span class="st">'Bond2Yr'</span>, <span class="st">'Bond5Yr'</span>, <span class="st">'Bond10Yr'</span>, <span class="st">'Bond15Yr'</span>, <span class="st">'Bond20Yr'</span>,<span class="st">'Bond30Yr'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Bond15Yr, <span class="sc">-</span>Bond20Yr, <span class="sc">-</span>Bond30Yr)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>sora <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Singapore Overnight Rate Average SORA Daily.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Rate'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Data Wrangling - to compute change (for SORA and Bond/Bill rates) and percentage change (for the various indices and prices)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PPI - percentage change computations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ppi_quarter <span class="ot">&lt;-</span> ppi <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_All</span><span class="st">`</span> <span class="ot">=</span> (PR_All <span class="sc">-</span> <span class="fu">lag</span>(PR_All))<span class="sc">/</span><span class="fu">lag</span>(PR_All)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_Landed</span><span class="st">`</span> <span class="ot">=</span> (PR_Landed <span class="sc">-</span> <span class="fu">lag</span>(PR_Landed))<span class="sc">/</span><span class="fu">lag</span>(PR_Landed)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_ALL</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_ALL <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_ALL))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_ALL)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_CCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_CCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_CCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_CCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_RCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_RCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_RCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_RCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_OCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_OCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_OCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_OCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Month) <span class="sc">%&gt;%</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'Year'</span>,<span class="st">'Quarter'</span>,<span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_month - percentage change computations</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>material_price_month <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_quarter_avg - percentage change computations</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>material_price_quarter_avg <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month) <span class="sc">%&gt;%</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_month_avg - percentage change computations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sti_month_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_quarter_avg - percentage change computations</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>sti_quarter_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span>         </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_month - rate change computations</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tbillbond_month_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_quarter_avg - percentage change computations</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>tbillbond_quarter_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_month - percentage change computations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sora_month_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_quarter_avg - percentage change computations</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>sora_quarter_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put all monthly data into 1 dataset</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> material_price_month <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthLabel =</span> <span class="fu">paste0</span>(Month, <span class="st">'M'</span>, <span class="fu">as.character</span>(Year))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">'01-'</span>, Month, <span class="st">'-'</span>, Year), <span class="at">format=</span><span class="st">"%d-%m-%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, MonthLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Month)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># put all quarter data into 1 dataset</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>data_by_quarter <span class="ot">&lt;-</span> ppi_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(material_price_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">QuarterLabel =</span> <span class="fu">paste0</span>(Quarter, <span class="fu">as.character</span>(Year)))  <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">paste0</span>(Year, <span class="st">'-'</span>, <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q1"</span>, <span class="st">"03"</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q2"</span>, <span class="st">"06"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q3"</span>, <span class="st">"09"</span>, <span class="st">"12"</span>))), <span class="st">"-01"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_by_month, <span class="st">"data/data_by_month.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_by_quarter, <span class="st">"data/data_by_quarter.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>month_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/data_by_month.csv'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>quarter_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/data_by_quarter.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>First we check the variables of both tables:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(month_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Date            MonthLabel            Cement          SteelBar     
 Length:222         Length:222         Min.   : 74.80   Min.   : 391.6  
 Class :character   Class :character   1st Qu.: 86.00   1st Qu.: 717.9  
 Mode  :character   Mode  :character   Median : 93.20   Median : 780.8  
                                       Mean   : 95.15   Mean   : 821.7  
                                       3rd Qu.:101.35   3rd Qu.: 913.4  
                                       Max.   :126.30   Max.   :1713.7  
                                                                        
    Granite      ConcretingSand  ReadyMixConcrete PCChange_Cement  
 Min.   :14.60   Min.   :12.09   Min.   : 72.48   Min.   :-4.7660  
 1st Qu.:17.52   1st Qu.:21.25   1st Qu.: 90.12   1st Qu.:-0.3994  
 Median :19.35   Median :23.90   Median :100.70   Median : 0.0000  
 Mean   :20.05   Mean   :25.02   Mean   :101.87   Mean   : 0.1314  
 3rd Qu.:21.20   3rd Qu.:28.10   3rd Qu.:111.17   3rd Qu.: 0.4842  
 Max.   :68.97   Max.   :60.00   Max.   :190.00   Max.   : 7.4649  
                                                                   
 PCChange_SteelBar  PCChange_Granite   PCChange_ConcretingSand
 Min.   :-17.4149   Min.   :-34.7552   Min.   :-12.5000       
 1st Qu.: -1.6301   1st Qu.: -1.4085   1st Qu.: -1.7731       
 Median : -0.3221   Median :  0.0000   Median :  0.0000       
 Mean   :  0.1559   Mean   :  0.6998   Mean   :  0.7289       
 3rd Qu.:  1.0772   3rd Qu.:  1.0088   3rd Qu.:  1.2821       
 Max.   : 19.6820   Max.   :230.0000   Max.   :122.6345       
                                                              
 PCChange_ReadyMixConcrete     Index      PCChange_Index        Bill1Yr      
 Min.   :-10.1933          Min.   :1591   Min.   :-22.8938   Min.   :0.1814  
 1st Qu.: -0.6955          1st Qu.:2819   1st Qu.: -1.8218   1st Qu.:0.3495  
 Median :  0.0000          Median :3118   Median :  0.3832   Median :0.9307  
 Mean   :  0.3634          Mean   :3000   Mean   :  0.2502   Mean   :1.2596  
 3rd Qu.:  0.3784          3rd Qu.:3237   3rd Qu.:  2.6730   3rd Qu.:1.9225  
 Max.   : 91.1469          Max.   :3787   Max.   : 19.5529   Max.   :4.1300  
                                                                             
    Bond2Yr          Bond5Yr          Bond10Yr     Change_Bill1Yr     
 Min.   :0.1355   Min.   :0.3441   Min.   :0.800   Min.   :-0.485591  
 1st Qu.:0.4440   1st Qu.:1.0684   1st Qu.:1.881   1st Qu.:-0.026110  
 Median :1.0149   Median :1.5646   Median :2.337   Median : 0.004091  
 Mean   :1.2805   Mean   :1.6764   Mean   :2.296   Mean   : 0.007893  
 3rd Qu.:1.9497   3rd Qu.:2.2394   3rd Qu.:2.711   3rd Qu.: 0.044283  
 Max.   :3.6732   Max.   :3.4645   Max.   :3.604   Max.   : 0.623636  
                                                                      
 Change_Bond2Yr      Change_Bond5Yr      Change_Bond10Yr           Rate        
 Min.   :-0.517046   Min.   :-0.533995   Min.   :-0.5103095   Min.   :0.02998  
 1st Qu.:-0.051878   1st Qu.:-0.079441   1st Qu.:-0.0818316   1st Qu.:0.09469  
 Median : 0.006621   Median :-0.007764   Median :-0.0087236   Median :0.27493  
 Mean   : 0.005881   Mean   : 0.002286   Mean   : 0.0008669   Mean   :0.91040  
 3rd Qu.: 0.060698   3rd Qu.: 0.086852   3rd Qu.: 0.0785649   3rd Qu.:1.45831  
 Max.   : 0.473636   Max.   : 0.704095   Max.   : 0.9062381   Max.   :3.74754  
                                                                               
  Change_Rate        Landed ($ PSF)   PCChange_Landed ($ PSF)
 Min.   :-0.766125   Min.   : 435.2   Min.   :-13.3204       
 1st Qu.:-0.046168   1st Qu.: 815.2   1st Qu.: -2.8110       
 Median : 0.002601   Median :1187.6   Median :  0.5539       
 Mean   : 0.008554   Mean   :1091.9   Mean   :  0.7268       
 3rd Qu.: 0.061680   3rd Qu.:1270.5   3rd Qu.:  4.0448       
 Max.   : 0.839497   Max.   :1839.4   Max.   : 19.1649       
 NA's   :1                                                   
 Non-Landed CCR ($ PSF) PCChange_Non-Landed CCR ($ PSF) Non-Landed RCR ($ PSF)
 Min.   : 802.7         Min.   :-24.8896                Min.   : 545.6        
 1st Qu.:1757.5         1st Qu.: -2.9663                1st Qu.:1094.2        
 Median :1926.6         Median :  0.5208                Median :1387.2        
 Mean   :1908.8         Mean   :  0.6299                Mean   :1353.1        
 3rd Qu.:2192.1         3rd Qu.:  4.2509                3rd Qu.:1646.1        
 Max.   :2674.5         Max.   : 23.1932                Max.   :2300.1        
                                                                              
 PCChange_Non-Landed RCR ($ PSF) Non-Landed OCR ($ PSF)
 Min.   :-23.6088                Min.   : 438.4        
 1st Qu.: -2.8856                1st Qu.: 777.0        
 Median :  0.2460                Median :1095.1        
 Mean   :  0.7891                Mean   :1035.2        
 3rd Qu.:  4.2799                3rd Qu.:1236.0        
 Max.   : 29.5848                Max.   :1929.2        
                                                       
 PCChange_Non-Landed OCR ($ PSF)
 Min.   :-20.6987               
 1st Qu.: -2.8455               
 Median :  0.2805               
 Mean   :  0.7547               
 3rd Qu.:  3.0962               
 Max.   : 25.0905               
                                </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quarter_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Date            QuarterLabel           PR_All        PR_Landed    
 Min.   :2005-09-01   Length:74          Min.   : 83.3   Min.   : 84.8  
 1st Qu.:2010-03-24   Class :character   1st Qu.:128.1   1st Qu.:130.4  
 Median :2014-10-16   Mode  :character   Median :146.2   Median :164.3  
 Mean   :2014-10-16                      Mean   :141.6   Mean   :156.2  
 3rd Qu.:2019-05-09                      3rd Qu.:152.8   3rd Qu.:175.4  
 Max.   :2023-12-01                      Max.   :201.5   Max.   :233.2  
                                                                        
   PR_NL_ALL       PR_NL_CCR       PR_NL_RCR       PR_NL_OCR    
 Min.   : 83.1   Min.   : 79.7   Min.   : 94.1   Min.   : 83.6  
 1st Qu.:129.4   1st Qu.:126.6   1st Qu.:134.4   1st Qu.:127.5  
 Median :140.9   Median :132.7   Median :147.4   Median :158.1  
 Mean   :138.2   Mean   :128.0   Mean   :145.6   Mean   :154.0  
 3rd Qu.:148.1   3rd Qu.:137.9   3rd Qu.:154.1   3rd Qu.:171.5  
 Max.   :194.2   Max.   :148.1   Max.   :213.9   Max.   :248.1  
                                                                
 PCChange_PR_All    PCChange_PR_Landed PCChange_PR_NL_ALL PCChange_PR_NL_CCR
 Min.   :-14.0893   Min.   :-9.1735    Min.   :-15.1104   Min.   :-16.2479  
 1st Qu.: -0.4112   1st Qu.:-0.8242    1st Qu.: -0.2894   1st Qu.: -0.5599  
 Median :  0.7929   Median : 0.9589    Median :  0.7262   Median :  0.6098  
 Mean   :  1.2792   Mean   : 1.4486    Mean   :  1.2393   Mean   :  0.9463  
 3rd Qu.:  2.7872   3rd Qu.: 3.6142    3rd Qu.:  2.4387   3rd Qu.:  2.2673  
 Max.   : 15.7398   Max.   :14.9003    Max.   : 15.9496   Max.   : 15.1899  
                                                                            
 PCChange_PR_NL_RCR PCChange_PR_NL_OCR     Cement          SteelBar     
 Min.   :-16.9435   Min.   :-7.3216    Min.   : 75.37   Min.   : 416.2  
 1st Qu.: -0.5996   1st Qu.:-0.1181    1st Qu.: 85.90   1st Qu.: 717.2  
 Median :  0.4096   Median : 1.0051    Median : 93.42   Median : 774.1  
 Mean   :  1.1859   Mean   : 1.5301    Mean   : 95.15   Mean   : 821.7  
 3rd Qu.:  2.5677   3rd Qu.: 2.1980    3rd Qu.:101.22   3rd Qu.: 916.2  
 Max.   : 18.5146   Max.   :16.0696    Max.   :125.91   Max.   :1626.9  
                                                                        
    Granite      ConcretingSand  ReadyMixConcrete PCChange_Cement  
 Min.   :14.83   Min.   :12.38   Min.   : 72.82   Min.   :-8.2837  
 1st Qu.:17.68   1st Qu.:21.73   1st Qu.: 90.61   1st Qu.:-1.0824  
 Median :19.45   Median :23.82   Median :101.28   Median : 0.2793  
 Mean   :20.05   Mean   :25.02   Mean   :101.87   Mean   : 0.4298  
 3rd Qu.:21.50   3rd Qu.:28.06   3rd Qu.:111.22   3rd Qu.: 1.8847  
 Max.   :41.82   Max.   :57.45   Max.   :168.80   Max.   :13.9593  
                                                                   
 PCChange_SteelBar  PCChange_Granite   PCChange_ConcretingSand
 Min.   :-32.9593   Min.   :-41.6501   Min.   :-20.8906       
 1st Qu.: -3.6214   1st Qu.: -3.6486   1st Qu.: -2.9350       
 Median : -1.0407   Median :  0.1429   Median : -0.2193       
 Mean   :  0.6331   Mean   :  1.0694   Mean   :  2.1542       
 3rd Qu.:  4.5361   3rd Qu.:  3.5446   3rd Qu.:  3.4565       
 Max.   : 32.9525   Max.   :101.2698   Max.   :115.1042       
                                                              
 PCChange_ReadyMixConcrete     Index      PCChange_Index        Bill1Yr      
 Min.   :-19.4708          Min.   :1674   Min.   :-33.7447   Min.   :0.2477  
 1st Qu.: -1.5607          1st Qu.:2839   1st Qu.: -1.5478   1st Qu.:0.3574  
 Median : -0.1701          Median :3118   Median :  1.1822   Median :0.9521  
 Mean   :  0.9889          Mean   :3000   Mean   :  0.8111   Mean   :1.2597  
 3rd Qu.:  1.2220          3rd Qu.:3240   3rd Qu.:  4.1286   3rd Qu.:1.9434  
 Max.   : 61.3151          Max.   :3600   Max.   : 27.1185   Max.   :3.9295  
                                                                             
    Bond2Yr          Bond5Yr          Bond10Yr      Change_Bill1Yr    
 Min.   :0.1787   Min.   :0.3778   Min.   :0.8854   Min.   :-0.99239  
 1st Qu.:0.4398   1st Qu.:1.0908   1st Qu.:1.8475   1st Qu.:-0.06383  
 Median :1.0306   Median :1.5938   Median :2.3358   Median : 0.01834  
 Mean   :1.2811   Mean   :1.6769   Mean   :2.2965   Mean   : 0.02373  
 3rd Qu.:1.9508   3rd Qu.:2.2000   3rd Qu.:2.7364   3rd Qu.: 0.11291  
 Max.   :3.5476   Max.   :3.2817   Max.   :3.5053   Max.   : 1.13440  
                                                                      
 Change_Bond2Yr     Change_Bond5Yr      Change_Bond10Yr          Rate        
 Min.   :-0.89210   Min.   :-0.825660   Min.   :-0.686901   Min.   :0.04001  
 1st Qu.:-0.07722   1st Qu.:-0.108647   1st Qu.:-0.165335   1st Qu.:0.11305  
 Median : 0.01397   Median :-0.005920   Median :-0.035819   Median :0.23987  
 Mean   : 0.01914   Mean   : 0.008438   Mean   : 0.003687   Mean   :0.91064  
 3rd Qu.: 0.12024   3rd Qu.: 0.164240   3rd Qu.: 0.205671   3rd Qu.:1.48863  
 Max.   : 0.95915   Max.   : 0.881261   Max.   : 0.818961   Max.   :3.67181  
                                                                             
  Change_Rate        Landed ($ PSF)   PCChange_Landed  Non-Landed CCR ($ PSF)
 Min.   :-0.705511   Min.   : 450.6   Min.   :-9.896   Min.   : 851.8        
 1st Qu.:-0.035194   1st Qu.: 831.9   1st Qu.:-1.231   1st Qu.:1797.1        
 Median : 0.007276   Median :1193.7   Median : 1.818   Median :1931.0        
 Mean   : 0.024368   Mean   :1092.6   Mean   : 1.942   Mean   :1914.1        
 3rd Qu.: 0.096097   3rd Qu.:1255.9   3rd Qu.: 5.447   3rd Qu.:2226.7        
 Max.   : 1.269015   Max.   :1812.9   Max.   :13.693   Max.   :2580.9        
 NA's   :1                                                                   
 PCChange_NonLandedCCR Non-Landed RCR ($ PSF) PCChange_NonLandedRCR
 Min.   :-20.788       Min.   : 586.4         Min.   :-10.8709     
 1st Qu.: -1.775       1st Qu.:1070.9         1st Qu.: -2.5762     
 Median :  1.478       Median :1404.6         Median :  0.3982     
 Mean   :  1.735       Mean   :1361.0         Mean   :  1.8772     
 3rd Qu.:  5.658       3rd Qu.:1650.2         3rd Qu.:  4.1783     
 Max.   : 24.211       Max.   :2204.3         Max.   : 31.4153     
                                                                   
 Non-Landed OCR ($ PSF) PCChange_NonLandedOCR
 Min.   : 452.8         Min.   :-15.279      
 1st Qu.: 777.2         1st Qu.: -1.724      
 Median :1112.5         Median :  1.625      
 Mean   :1040.5         Mean   :  1.992      
 3rd Qu.:1239.9         3rd Qu.:  5.391      
 Max.   :1729.6         Max.   : 20.638      
                                             </code></pre>
</div>
</div>
<p>We can see that there is no corresponding data for PPI in month_data, and secondly, there are a lot of variables. In order to make it easier for the user to choose, I have used the following code to divide the variables into four categories: PPI, Materials, Index and Financial. Providing a clear path of choices is essential for managing complex datasets, especially when dealing with multiple sources or categories. This approach reduces information overload, enabling users to perform focused analyses quickly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>categories_quarter <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">PPI =</span> <span class="fu">c</span>(<span class="st">"PR_All"</span>, <span class="st">"PR_Landed"</span>, <span class="st">"PR_NL_ALL"</span>, <span class="st">"PR_NL_CCR"</span>, <span class="st">"PR_NL_RCR"</span>, <span class="st">"PR_NL_OCR"</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Materials =</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">"Index"</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Financial =</span>  <span class="fu">c</span>(<span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>categories_month <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Materials =</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">"Index"</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Financial =</span>  <span class="fu">c</span>(<span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, both datasets count the variable change, so we deal with the data variable of change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>categories_changes_quarter <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(categories_quarter), <span class="cf">function</span>(category) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">!=</span> <span class="st">"Financial"</span>) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"%Change_"</span>, categories_quarter[[category]])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Change_"</span>, categories_quarter[[category]])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>categories_changes_month <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(categories_month), <span class="cf">function</span>(category) {</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">!=</span> <span class="st">"Financial"</span>) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"%Change_"</span>, categories_month[[category]])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Change_"</span>, categories_month[[category]])</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>categories_changes_quarter <span class="ot">&lt;-</span> <span class="fu">setNames</span>(categories_changes_quarter, <span class="fu">names</span>(categories_quarter))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>categories_changes_month <span class="ot">&lt;-</span> <span class="fu">setNames</span>(categories_changes_month, <span class="fu">names</span>(categories_month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These code snippets take two lists categorized by quarters and months, respectively, iterate over each category within these lists, and create new lists where the variables are renamed to indicate changes (either percentage or absolute changes).</p>
<p>Next,Pre-processing of quarterly and monthly data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>quarter_data<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(quarter_data<span class="sc">$</span>QuarterLabel, <span class="dv">3</span>, <span class="dv">6</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>quarter_data<span class="sc">$</span>Quarter <span class="ot">&lt;-</span> <span class="fu">substr</span>(quarter_data<span class="sc">$</span>QuarterLabel, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>month_data<span class="sc">$</span>Year <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(month_data<span class="sc">$</span>Date)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>month_data<span class="sc">$</span>Month <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">month</span>(month_data<span class="sc">$</span>Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="design-for-eda" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="design-for-eda"><span class="header-section-number">3</span> Design for EDA</h2>
<p>In this exercise, I will be responsible for the EDA part of our group project shinyapp, here is my <a href="https://isss608-cjh.shinyapps.io/ProjectEDA/">Shinyapp Prototype</a>. --https://isss608-cjh.shinyapps.io/ProjectEDA/</p>
<section id="overview" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">3.1</span> Overview</h3>
<p><img src="images/2efc099809aabed84023ab172898874.png" class="img-fluid"></p>
<p>This UI is designed for a Shiny app, structured using <strong><code>dashboardPage</code></strong> from the <strong><code>shinydashboard</code></strong> package, aiming to provide a user-friendly interface for Exploratory Data Analysis (EDA).</p>
<p>The sidebar is organized into main analysis types - Trend, Distribution, Autocorrelation, and Crosscorrelation - to guide the user through the different facets of EDA. Users can click on these to switch between different analyses.</p>
</section>
<section id="trend" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="trend"><span class="header-section-number">3.2</span> Trend</h3>
<section id="test-code" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="test-code"><span class="header-section-number">3.2.1</span> <strong>Test Code</strong></h4>
<p>We test the Trend Line Plot in Index variable using <code>plotly</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(month_data, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> .data[[<span class="st">"Index"</span>]])) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#3366CC"</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Trend of"</span>, <span class="at">y =</span> <span class="st">"Index"</span>, <span class="st">"over Time"</span>), <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Index"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.size =</span> <span class="dv">18</span>, <span class="at">title.color =</span> <span class="st">"#333333"</span>) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>), </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">size =</span> <span class="dv">14</span>), </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#D3D3D3"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>), <span class="co"># </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#F8F8F8"</span>) </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-37edd94e9fdd939e3b9e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-37edd94e9fdd939e3b9e">{"x":{"data":[{"x":[1,null,2,null,3,null,4,null,5,null,6,null,7,null,8,null,9,null,10,null,11,null,12,null,13,null,14,null,15,null,16,null,17,null,18,null,19,null,20,null,21,null,22,null,23,null,24,null,25,null,26,null,27,null,28,null,29,null,30,null,31,null,32,null,33,null,34,null,35,null,36,null,37,null,38,null,39,null,40,null,41,null,42,null,43,null,44,null,45,null,46,null,47,null,48,null,49,null,50,null,51,null,52,null,53,null,54,null,55,null,56,null,57,null,58,null,59,null,60,null,61,null,62,null,63,null,64,null,65,null,66,null,67,null,68,null,69,null,70,null,71,null,72,null,73,null,74,null,75,null,76,null,77,null,78,null,79,null,80,null,81,null,82,null,83,null,84,null,85,null,86,null,87,null,88,null,89,null,90,null,91,null,92,null,93,null,94,null,95,null,96,null,97,null,98,null,99,null,100,null,101,null,102,null,103,null,104,null,105,null,106,null,107,null,108,null,109,null,110,null,111,null,112,null,113,null,114,null,115,null,116,null,117,null,118,null,119,null,120,null,121,null,122,null,123,null,124,null,125,null,126,null,127,null,128,null,129,null,130,null,131,null,132,null,133,null,134,null,135,null,136,null,137,null,138,null,139,null,140,null,141,null,142,null,143,null,144,null,145,null,146,null,147,null,148,null,149,null,150,null,151,null,152,null,153,null,154,null,155,null,156,null,157,null,158,null,159,null,160,null,161,null,162,null,163,null,164,null,165,null,166,null,167,null,168,null,169,null,170,null,171,null,172,null,173,null,174,null,175,null,176,null,177,null,178,null,179,null,180,null,181,null,182,null,183,null,184,null,185,null,186,null,187,null,188,null,189,null,190,null,191,null,192,null,193,null,194,null,195,null,196,null,197,null,198,null,199,null,200,null,201,null,202,null,203,null,204,null,205,null,206,null,207,null,208,null,209,null,210,null,211,null,212,null,213,null,214,null,215,null,216,null,217,null,218,null,219,null,220,null,221,null,222],"y":[2273.0938099999998,null,2276.0149999999999,null,2326.6619049999999,null,2270.3995239999999,null,2308.8795449999998,null,2303.0613640000001,null,2391.7977780000001,null,2660.7485710000001,null,2779.2377270000002,null,2913.0684999999999,null,2439.7824999999998,null,2502.7782609999999,null,2567.196316,null,2529.3480949999998,null,2354.9054550000001,null,2404.7980950000001,null,2458.8345450000002,null,2524.9238099999998,null,3061.6323809999999,null,3787.106522,null,3503.3942860000002,null,3481.494737,null,3223.1788889999998,null,3135.701818,null,3368.8629999999998,null,3492.2361900000001,null,3569.1023810000002,null,3597.002727,null,3336.497273,null,3531.1875,null,3166.150455,null,1959.3280950000001,null,1753.3585,null,1740.939048,null,3030.6900000000001,null,2903.6624999999999,null,3135.0268179999998,null,3185.569,null,3040.143333,null,2903.3282610000001,null,2786.2104760000002,null,2541.0786360000002,null,1777.257895,null,2669.522273,null,2723.8634999999999,null,2816.7963639999998,null,1668.03,null,1590.9100000000001,null,1846.314762,null,2207.3225000000002,null,2325.5327269999998,null,2420.2265219999999,null,2599.0369999999998,null,2649.7990479999999,null,2864.3690000000001,null,3166.9471429999999,null,3213.1260000000002,null,3173.1882609999998,null,2747.6961110000002,null,2866.3152169999998,null,2978.1857140000002,null,2808.9085,null,2813.0818180000001,null,2928.4722729999999,null,2954.8066669999998,null,3060.435238,null,3230.2890480000001,null,2713.6015000000002,null,2763.8557139999998,null,2691.2676190000002,null,3091.916111,null,3036.5382610000001,null,3162.8615,null,3138.0985000000001,null,3077.5063639999998,null,3134.472381,null,2879.9319049999999,null,2761.502727,null,2791.9505260000001,null,3054.9904550000001,null,3002.4095240000001,null,3139.6819999999998,null,2971.288571,null,2988.1236359999998,null,2984.8665000000001,null,2854.9254550000001,null,2797.1328570000001,null,2987.485455,null,3052.8514289999998,null,3042.2824999999998,null,3229.477727,null,3182.5018180000002,null,3187.3757139999998,null,3112.0485709999998,null,3282.6094440000002,null,3278.2505000000001,null,3310.110455,null,3409.049524,null,3172.1089999999999,null,3209.055652,null,3155.819,null,3144.089524,null,3115.8819050000002,null,3220.4885709999999,null,3312.9699999999998,null,3312.2059089999998,null,3049.9630000000002,null,3112.5100000000002,null,3232.840952,null,3262.5630000000001,null,3280.4309520000002,null,3305.8877269999998,null,3318.5333329999999,null,3314.0872730000001,null,3353.9266670000002,null,2984.0650000000001,null,2939.3604999999998,null,2863.4154549999998,null,3424.2561110000001,null,3404.7186360000001,null,3491.6290479999998,null,3449.1315,null,3325.4780949999999,null,3316.8859090000001,null,3039.8415789999999,null,2862.125,null,2654.7545,null,2843.947619,null,2824.6809090000002,null,2922.7719050000001,null,2611.9521049999998,null,2829.8227270000002,null,2872.9185710000002,null,2764.2342859999999,null,2794.1863640000001,null,2904.1824999999999,null,2852.0459089999999,null,2851.1799999999998,null,3002.9915000000001,null,3315.7033329999999,null,3408.2627269999998,null,3416.8895000000002,null,3088.9385000000002,null,3144.4265220000002,null,3163.988421,null,3229.8414290000001,null,3234.2538100000002,null,3279.1819049999999,null,3289.255909,null,3226.3739999999998,null,3533.9190910000002,null,3094.7704349999999,null,3071.7804759999999,null,3085.2545,null,3468.746842,null,3481.0252380000002,null,3505.4933329999999,null,3532.8990480000002,null,3361.4234999999999,null,3268.9299999999998,null,3251.6828569999998,null,3177.3905,null,3166.3509089999998,null,3134.9299999999998,null,3234.7266669999999,null,3199.0842859999998,null,3237.2049999999999,null,3210.3066669999998,null,3335.9071429999999,null,3227.8771430000002,null,3240.2673679999998,null,3357.1813040000002,null,3140.4825000000001,null,3151.2814290000001,null,3237.5466670000001,null,2520.3577270000001,null,2719.472381,null,2839.7009090000001,null,3171.6019999999999,null,2629.7854550000002,null,2549.6052380000001,null,2552.7783330000002,null,2663.8577270000001,null,2619.4980949999999,null,2545.3180000000002,null,2493.8136359999999,null,2955.9794999999999,null,3153.2661899999998,null,3216.2595240000001,null,3113.873478,null,2919.3478949999999,null,3098.02,null,3195.762381,null,3143.5410529999999,null,3143.8631820000001,null,3144.6814290000002,null,3134.1195240000002,null,3076.7459090000002,null,3244.5852380000001,null,3064.473,null,3217.701364,null,3257.679048,null,3382.6483330000001,null,3306.0247829999998,null,3359.6410000000001,null,3233.3863160000001,null,3152.4586359999998,null,3145.096,null,3255.7931819999999,null,3223.6463640000002,null,3302.6810529999998,null,3135.0390910000001,null,3112.5204760000001,null,3120.806,null,3327.6574999999998,null,3210.3800000000001,null,3302.252105,null,3220.3918180000001,null,3205.6190000000001,null,3244.6285710000002,null,3243.173182,null,3225.6779999999999],"text":["Date: 2005/10/1<br />Index: 2273.094",null,"Date: 2005/11/1<br />Index: 2276.015",null,"Date: 2005/12/1<br />Index: 2326.662",null,"Date: 2005/7/1<br />Index: 2270.400",null,"Date: 2005/8/1<br />Index: 2308.880",null,"Date: 2005/9/1<br />Index: 2303.061",null,"Date: 2006/1/1<br />Index: 2391.798",null,"Date: 2006/10/1<br />Index: 2660.749",null,"Date: 2006/11/1<br />Index: 2779.238",null,"Date: 2006/12/1<br />Index: 2913.068",null,"Date: 2006/2/1<br />Index: 2439.782",null,"Date: 2006/3/1<br />Index: 2502.778",null,"Date: 2006/4/1<br />Index: 2567.196",null,"Date: 2006/5/1<br />Index: 2529.348",null,"Date: 2006/6/1<br />Index: 2354.905",null,"Date: 2006/7/1<br />Index: 2404.798",null,"Date: 2006/8/1<br />Index: 2458.835",null,"Date: 2006/9/1<br />Index: 2524.924",null,"Date: 2007/1/1<br />Index: 3061.632",null,"Date: 2007/10/1<br />Index: 3787.107",null,"Date: 2007/11/1<br />Index: 3503.394",null,"Date: 2007/12/1<br />Index: 3481.495",null,"Date: 2007/2/1<br />Index: 3223.179",null,"Date: 2007/3/1<br />Index: 3135.702",null,"Date: 2007/4/1<br />Index: 3368.863",null,"Date: 2007/5/1<br />Index: 3492.236",null,"Date: 2007/6/1<br />Index: 3569.102",null,"Date: 2007/7/1<br />Index: 3597.003",null,"Date: 2007/8/1<br />Index: 3336.497",null,"Date: 2007/9/1<br />Index: 3531.188",null,"Date: 2008/1/1<br />Index: 3166.150",null,"Date: 2008/10/1<br />Index: 1959.328",null,"Date: 2008/11/1<br />Index: 1753.359",null,"Date: 2008/12/1<br />Index: 1740.939",null,"Date: 2008/2/1<br />Index: 3030.690",null,"Date: 2008/3/1<br />Index: 2903.662",null,"Date: 2008/4/1<br />Index: 3135.027",null,"Date: 2008/5/1<br />Index: 3185.569",null,"Date: 2008/6/1<br />Index: 3040.143",null,"Date: 2008/7/1<br />Index: 2903.328",null,"Date: 2008/8/1<br />Index: 2786.210",null,"Date: 2008/9/1<br />Index: 2541.079",null,"Date: 2009/1/1<br />Index: 1777.258",null,"Date: 2009/10/1<br />Index: 2669.522",null,"Date: 2009/11/1<br />Index: 2723.863",null,"Date: 2009/12/1<br />Index: 2816.796",null,"Date: 2009/2/1<br />Index: 1668.030",null,"Date: 2009/3/1<br />Index: 1590.910",null,"Date: 2009/4/1<br />Index: 1846.315",null,"Date: 2009/5/1<br />Index: 2207.323",null,"Date: 2009/6/1<br />Index: 2325.533",null,"Date: 2009/7/1<br />Index: 2420.227",null,"Date: 2009/8/1<br />Index: 2599.037",null,"Date: 2009/9/1<br />Index: 2649.799",null,"Date: 2010/1/1<br />Index: 2864.369",null,"Date: 2010/10/1<br />Index: 3166.947",null,"Date: 2010/11/1<br />Index: 3213.126",null,"Date: 2010/12/1<br />Index: 3173.188",null,"Date: 2010/2/1<br />Index: 2747.696",null,"Date: 2010/3/1<br />Index: 2866.315",null,"Date: 2010/4/1<br />Index: 2978.186",null,"Date: 2010/5/1<br />Index: 2808.909",null,"Date: 2010/6/1<br />Index: 2813.082",null,"Date: 2010/7/1<br />Index: 2928.472",null,"Date: 2010/8/1<br />Index: 2954.807",null,"Date: 2010/9/1<br />Index: 3060.435",null,"Date: 2011/1/1<br />Index: 3230.289",null,"Date: 2011/10/1<br />Index: 2713.602",null,"Date: 2011/11/1<br />Index: 2763.856",null,"Date: 2011/12/1<br />Index: 2691.268",null,"Date: 2011/2/1<br />Index: 3091.916",null,"Date: 2011/3/1<br />Index: 3036.538",null,"Date: 2011/4/1<br />Index: 3162.861",null,"Date: 2011/5/1<br />Index: 3138.099",null,"Date: 2011/6/1<br />Index: 3077.506",null,"Date: 2011/7/1<br />Index: 3134.472",null,"Date: 2011/8/1<br />Index: 2879.932",null,"Date: 2011/9/1<br />Index: 2761.503",null,"Date: 2012/1/1<br />Index: 2791.951",null,"Date: 2012/10/1<br />Index: 3054.990",null,"Date: 2012/11/1<br />Index: 3002.410",null,"Date: 2012/12/1<br />Index: 3139.682",null,"Date: 2012/2/1<br />Index: 2971.289",null,"Date: 2012/3/1<br />Index: 2988.124",null,"Date: 2012/4/1<br />Index: 2984.867",null,"Date: 2012/5/1<br />Index: 2854.925",null,"Date: 2012/6/1<br />Index: 2797.133",null,"Date: 2012/7/1<br />Index: 2987.485",null,"Date: 2012/8/1<br />Index: 3052.851",null,"Date: 2012/9/1<br />Index: 3042.282",null,"Date: 2013/1/1<br />Index: 3229.478",null,"Date: 2013/10/1<br />Index: 3182.502",null,"Date: 2013/11/1<br />Index: 3187.376",null,"Date: 2013/12/1<br />Index: 3112.049",null,"Date: 2013/2/1<br />Index: 3282.609",null,"Date: 2013/3/1<br />Index: 3278.251",null,"Date: 2013/4/1<br />Index: 3310.110",null,"Date: 2013/5/1<br />Index: 3409.050",null,"Date: 2013/6/1<br />Index: 3172.109",null,"Date: 2013/7/1<br />Index: 3209.056",null,"Date: 2013/8/1<br />Index: 3155.819",null,"Date: 2013/9/1<br />Index: 3144.090",null,"Date: 2014/1/1<br />Index: 3115.882",null,"Date: 2014/10/1<br />Index: 3220.489",null,"Date: 2014/11/1<br />Index: 3312.970",null,"Date: 2014/12/1<br />Index: 3312.206",null,"Date: 2014/2/1<br />Index: 3049.963",null,"Date: 2014/3/1<br />Index: 3112.510",null,"Date: 2014/4/1<br />Index: 3232.841",null,"Date: 2014/5/1<br />Index: 3262.563",null,"Date: 2014/6/1<br />Index: 3280.431",null,"Date: 2014/7/1<br />Index: 3305.888",null,"Date: 2014/8/1<br />Index: 3318.533",null,"Date: 2014/9/1<br />Index: 3314.087",null,"Date: 2015/1/1<br />Index: 3353.927",null,"Date: 2015/10/1<br />Index: 2984.065",null,"Date: 2015/11/1<br />Index: 2939.360",null,"Date: 2015/12/1<br />Index: 2863.415",null,"Date: 2015/2/1<br />Index: 3424.256",null,"Date: 2015/3/1<br />Index: 3404.719",null,"Date: 2015/4/1<br />Index: 3491.629",null,"Date: 2015/5/1<br />Index: 3449.131",null,"Date: 2015/6/1<br />Index: 3325.478",null,"Date: 2015/7/1<br />Index: 3316.886",null,"Date: 2015/8/1<br />Index: 3039.842",null,"Date: 2015/9/1<br />Index: 2862.125",null,"Date: 2016/1/1<br />Index: 2654.755",null,"Date: 2016/10/1<br />Index: 2843.948",null,"Date: 2016/11/1<br />Index: 2824.681",null,"Date: 2016/12/1<br />Index: 2922.772",null,"Date: 2016/2/1<br />Index: 2611.952",null,"Date: 2016/3/1<br />Index: 2829.823",null,"Date: 2016/4/1<br />Index: 2872.919",null,"Date: 2016/5/1<br />Index: 2764.234",null,"Date: 2016/6/1<br />Index: 2794.186",null,"Date: 2016/7/1<br />Index: 2904.182",null,"Date: 2016/8/1<br />Index: 2852.046",null,"Date: 2016/9/1<br />Index: 2851.180",null,"Date: 2017/1/1<br />Index: 3002.992",null,"Date: 2017/10/1<br />Index: 3315.703",null,"Date: 2017/11/1<br />Index: 3408.263",null,"Date: 2017/12/1<br />Index: 3416.890",null,"Date: 2017/2/1<br />Index: 3088.939",null,"Date: 2017/3/1<br />Index: 3144.427",null,"Date: 2017/4/1<br />Index: 3163.988",null,"Date: 2017/5/1<br />Index: 3229.841",null,"Date: 2017/6/1<br />Index: 3234.254",null,"Date: 2017/7/1<br />Index: 3279.182",null,"Date: 2017/8/1<br />Index: 3289.256",null,"Date: 2017/9/1<br />Index: 3226.374",null,"Date: 2018/1/1<br />Index: 3533.919",null,"Date: 2018/10/1<br />Index: 3094.770",null,"Date: 2018/11/1<br />Index: 3071.780",null,"Date: 2018/12/1<br />Index: 3085.255",null,"Date: 2018/2/1<br />Index: 3468.747",null,"Date: 2018/3/1<br />Index: 3481.025",null,"Date: 2018/4/1<br />Index: 3505.493",null,"Date: 2018/5/1<br />Index: 3532.899",null,"Date: 2018/6/1<br />Index: 3361.423",null,"Date: 2018/7/1<br />Index: 3268.930",null,"Date: 2018/8/1<br />Index: 3251.683",null,"Date: 2018/9/1<br />Index: 3177.390",null,"Date: 2019/1/1<br />Index: 3166.351",null,"Date: 2019/10/1<br />Index: 3134.930",null,"Date: 2019/11/1<br />Index: 3234.727",null,"Date: 2019/12/1<br />Index: 3199.084",null,"Date: 2019/2/1<br />Index: 3237.205",null,"Date: 2019/3/1<br />Index: 3210.307",null,"Date: 2019/4/1<br />Index: 3335.907",null,"Date: 2019/5/1<br />Index: 3227.877",null,"Date: 2019/6/1<br />Index: 3240.267",null,"Date: 2019/7/1<br />Index: 3357.181",null,"Date: 2019/8/1<br />Index: 3140.483",null,"Date: 2019/9/1<br />Index: 3151.281",null,"Date: 2020/1/1<br />Index: 3237.547",null,"Date: 2020/10/1<br />Index: 2520.358",null,"Date: 2020/11/1<br />Index: 2719.472",null,"Date: 2020/12/1<br />Index: 2839.701",null,"Date: 2020/2/1<br />Index: 3171.602",null,"Date: 2020/3/1<br />Index: 2629.785",null,"Date: 2020/4/1<br />Index: 2549.605",null,"Date: 2020/5/1<br />Index: 2552.778",null,"Date: 2020/6/1<br />Index: 2663.858",null,"Date: 2020/7/1<br />Index: 2619.498",null,"Date: 2020/8/1<br />Index: 2545.318",null,"Date: 2020/9/1<br />Index: 2493.814",null,"Date: 2021/1/1<br />Index: 2955.979",null,"Date: 2021/10/1<br />Index: 3153.266",null,"Date: 2021/11/1<br />Index: 3216.260",null,"Date: 2021/12/1<br />Index: 3113.873",null,"Date: 2021/2/1<br />Index: 2919.348",null,"Date: 2021/3/1<br />Index: 3098.020",null,"Date: 2021/4/1<br />Index: 3195.762",null,"Date: 2021/5/1<br />Index: 3143.541",null,"Date: 2021/6/1<br />Index: 3143.863",null,"Date: 2021/7/1<br />Index: 3144.681",null,"Date: 2021/8/1<br />Index: 3134.120",null,"Date: 2021/9/1<br />Index: 3076.746",null,"Date: 2022/1/1<br />Index: 3244.585",null,"Date: 2022/10/1<br />Index: 3064.473",null,"Date: 2022/11/1<br />Index: 3217.701",null,"Date: 2022/12/1<br />Index: 3257.679",null,"Date: 2022/2/1<br />Index: 3382.648",null,"Date: 2022/3/1<br />Index: 3306.025",null,"Date: 2022/4/1<br />Index: 3359.641",null,"Date: 2022/5/1<br />Index: 3233.386",null,"Date: 2022/6/1<br />Index: 3152.459",null,"Date: 2022/7/1<br />Index: 3145.096",null,"Date: 2022/8/1<br />Index: 3255.793",null,"Date: 2022/9/1<br />Index: 3223.646",null,"Date: 2023/1/1<br />Index: 3302.681",null,"Date: 2023/10/1<br />Index: 3135.039",null,"Date: 2023/11/1<br />Index: 3112.520",null,"Date: 2023/12/1<br />Index: 3120.806",null,"Date: 2023/2/1<br />Index: 3327.657",null,"Date: 2023/3/1<br />Index: 3210.380",null,"Date: 2023/4/1<br />Index: 3302.252",null,"Date: 2023/5/1<br />Index: 3220.392",null,"Date: 2023/6/1<br />Index: 3205.619",null,"Date: 2023/7/1<br />Index: 3244.629",null,"Date: 2023/8/1<br />Index: 3243.173",null,"Date: 2023/9/1<br />Index: 3225.678"],"type":"scatter","mode":"lines","line":{"width":4.5354330708661417,"color":"rgba(51,102,204,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":48.418430884184303,"l":61.436280614362801},"plot_bgcolor":"rgba(248,248,248,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Trend of Index over Time","font":{"color":"rgba(0,0,0,1)","family":"Arial","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,222.59999999999999],"tickmode":"array","ticktext":["2005/10/1","2005/11/1","2005/12/1","2005/7/1","2005/8/1","2005/9/1","2006/1/1","2006/10/1","2006/11/1","2006/12/1","2006/2/1","2006/3/1","2006/4/1","2006/5/1","2006/6/1","2006/7/1","2006/8/1","2006/9/1","2007/1/1","2007/10/1","2007/11/1","2007/12/1","2007/2/1","2007/3/1","2007/4/1","2007/5/1","2007/6/1","2007/7/1","2007/8/1","2007/9/1","2008/1/1","2008/10/1","2008/11/1","2008/12/1","2008/2/1","2008/3/1","2008/4/1","2008/5/1","2008/6/1","2008/7/1","2008/8/1","2008/9/1","2009/1/1","2009/10/1","2009/11/1","2009/12/1","2009/2/1","2009/3/1","2009/4/1","2009/5/1","2009/6/1","2009/7/1","2009/8/1","2009/9/1","2010/1/1","2010/10/1","2010/11/1","2010/12/1","2010/2/1","2010/3/1","2010/4/1","2010/5/1","2010/6/1","2010/7/1","2010/8/1","2010/9/1","2011/1/1","2011/10/1","2011/11/1","2011/12/1","2011/2/1","2011/3/1","2011/4/1","2011/5/1","2011/6/1","2011/7/1","2011/8/1","2011/9/1","2012/1/1","2012/10/1","2012/11/1","2012/12/1","2012/2/1","2012/3/1","2012/4/1","2012/5/1","2012/6/1","2012/7/1","2012/8/1","2012/9/1","2013/1/1","2013/10/1","2013/11/1","2013/12/1","2013/2/1","2013/3/1","2013/4/1","2013/5/1","2013/6/1","2013/7/1","2013/8/1","2013/9/1","2014/1/1","2014/10/1","2014/11/1","2014/12/1","2014/2/1","2014/3/1","2014/4/1","2014/5/1","2014/6/1","2014/7/1","2014/8/1","2014/9/1","2015/1/1","2015/10/1","2015/11/1","2015/12/1","2015/2/1","2015/3/1","2015/4/1","2015/5/1","2015/6/1","2015/7/1","2015/8/1","2015/9/1","2016/1/1","2016/10/1","2016/11/1","2016/12/1","2016/2/1","2016/3/1","2016/4/1","2016/5/1","2016/6/1","2016/7/1","2016/8/1","2016/9/1","2017/1/1","2017/10/1","2017/11/1","2017/12/1","2017/2/1","2017/3/1","2017/4/1","2017/5/1","2017/6/1","2017/7/1","2017/8/1","2017/9/1","2018/1/1","2018/10/1","2018/11/1","2018/12/1","2018/2/1","2018/3/1","2018/4/1","2018/5/1","2018/6/1","2018/7/1","2018/8/1","2018/9/1","2019/1/1","2019/10/1","2019/11/1","2019/12/1","2019/2/1","2019/3/1","2019/4/1","2019/5/1","2019/6/1","2019/7/1","2019/8/1","2019/9/1","2020/1/1","2020/10/1","2020/11/1","2020/12/1","2020/2/1","2020/3/1","2020/4/1","2020/5/1","2020/6/1","2020/7/1","2020/8/1","2020/9/1","2021/1/1","2021/10/1","2021/11/1","2021/12/1","2021/2/1","2021/3/1","2021/4/1","2021/5/1","2021/6/1","2021/7/1","2021/8/1","2021/9/1","2022/1/1","2022/10/1","2022/11/1","2022/12/1","2022/2/1","2022/3/1","2022/4/1","2022/5/1","2022/6/1","2022/7/1","2022/8/1","2022/9/1","2023/1/1","2023/10/1","2023/11/1","2023/12/1","2023/2/1","2023/3/1","2023/4/1","2023/5/1","2023/6/1","2023/7/1","2023/8/1","2023/9/1"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15.000000000000002,15.999999999999998,17,18,19,20,21,22,23,24,25,26,27,28,28.999999999999996,30,31,32.000000000000007,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56.000000000000007,57,58,58.999999999999993,60.000000000000007,61,62,63,63.999999999999993,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,112.99999999999999,114,115.00000000000001,116,117,117.99999999999999,119,120.00000000000001,121,122,122.99999999999999,124,125.00000000000001,126,127,127.99999999999999,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222],"categoryorder":"array","categoryarray":["2005/10/1","2005/11/1","2005/12/1","2005/7/1","2005/8/1","2005/9/1","2006/1/1","2006/10/1","2006/11/1","2006/12/1","2006/2/1","2006/3/1","2006/4/1","2006/5/1","2006/6/1","2006/7/1","2006/8/1","2006/9/1","2007/1/1","2007/10/1","2007/11/1","2007/12/1","2007/2/1","2007/3/1","2007/4/1","2007/5/1","2007/6/1","2007/7/1","2007/8/1","2007/9/1","2008/1/1","2008/10/1","2008/11/1","2008/12/1","2008/2/1","2008/3/1","2008/4/1","2008/5/1","2008/6/1","2008/7/1","2008/8/1","2008/9/1","2009/1/1","2009/10/1","2009/11/1","2009/12/1","2009/2/1","2009/3/1","2009/4/1","2009/5/1","2009/6/1","2009/7/1","2009/8/1","2009/9/1","2010/1/1","2010/10/1","2010/11/1","2010/12/1","2010/2/1","2010/3/1","2010/4/1","2010/5/1","2010/6/1","2010/7/1","2010/8/1","2010/9/1","2011/1/1","2011/10/1","2011/11/1","2011/12/1","2011/2/1","2011/3/1","2011/4/1","2011/5/1","2011/6/1","2011/7/1","2011/8/1","2011/9/1","2012/1/1","2012/10/1","2012/11/1","2012/12/1","2012/2/1","2012/3/1","2012/4/1","2012/5/1","2012/6/1","2012/7/1","2012/8/1","2012/9/1","2013/1/1","2013/10/1","2013/11/1","2013/12/1","2013/2/1","2013/3/1","2013/4/1","2013/5/1","2013/6/1","2013/7/1","2013/8/1","2013/9/1","2014/1/1","2014/10/1","2014/11/1","2014/12/1","2014/2/1","2014/3/1","2014/4/1","2014/5/1","2014/6/1","2014/7/1","2014/8/1","2014/9/1","2015/1/1","2015/10/1","2015/11/1","2015/12/1","2015/2/1","2015/3/1","2015/4/1","2015/5/1","2015/6/1","2015/7/1","2015/8/1","2015/9/1","2016/1/1","2016/10/1","2016/11/1","2016/12/1","2016/2/1","2016/3/1","2016/4/1","2016/5/1","2016/6/1","2016/7/1","2016/8/1","2016/9/1","2017/1/1","2017/10/1","2017/11/1","2017/12/1","2017/2/1","2017/3/1","2017/4/1","2017/5/1","2017/6/1","2017/7/1","2017/8/1","2017/9/1","2018/1/1","2018/10/1","2018/11/1","2018/12/1","2018/2/1","2018/3/1","2018/4/1","2018/5/1","2018/6/1","2018/7/1","2018/8/1","2018/9/1","2019/1/1","2019/10/1","2019/11/1","2019/12/1","2019/2/1","2019/3/1","2019/4/1","2019/5/1","2019/6/1","2019/7/1","2019/8/1","2019/9/1","2020/1/1","2020/10/1","2020/11/1","2020/12/1","2020/2/1","2020/3/1","2020/4/1","2020/5/1","2020/6/1","2020/7/1","2020/8/1","2020/9/1","2021/1/1","2021/10/1","2021/11/1","2021/12/1","2021/2/1","2021/3/1","2021/4/1","2021/5/1","2021/6/1","2021/7/1","2021/8/1","2021/9/1","2022/1/1","2022/10/1","2022/11/1","2022/12/1","2022/2/1","2022/3/1","2022/4/1","2022/5/1","2022/6/1","2022/7/1","2022/8/1","2022/9/1","2023/1/1","2023/10/1","2023/11/1","2023/12/1","2023/2/1","2023/3/1","2023/4/1","2023/5/1","2023/6/1","2023/7/1","2023/8/1","2023/9/1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial","size":15.940224159402243},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(211,211,211,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"Arial","size":18.596928185969279}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1481.1001739000001,3896.9163481000001],"tickmode":"array","ticktext":["1500","2000","2500","3000","3500"],"tickvals":[1500,2000,2500,3000,3500],"categoryorder":"array","categoryarray":["1500","2000","2500","3000","3500"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial","size":15.940224159402243},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(211,211,211,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Index","font":{"color":"rgba(0,0,0,1)","family":"Arial","size":18.596928185969279}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"7b805b1a5a0c":{"x":{},"y":{},"type":"scatter"}},"cur_data":"7b805b1a5a0c","visdat":{"7b805b1a5a0c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="ui-design" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="ui-design"><span class="header-section-number">3.2.2</span> Ui Design</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/e8a04a001a900c202d66b6eaadc15ba.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><strong>Filter Panel:</strong></p>
<p>Within the Trend analysis tab, the sidebar serves as a filter panel where users can customize the data they wish to analyze by:</p>
<ul>
<li><p><strong>View by:</strong> Allows selection between Quarter and Month, catering to datasets with different temporal resolutions. (When selecting Month, PPI cannot be selected due to missing data)</p></li>
<li><p><strong>Choose a category:</strong> Enables the selection of a data category (PPI, Materials, Index, Financial), which represents different variable categories.</p></li>
<li><p><strong>Choose a variable:</strong> Offers a dropdown to select specific variables within the chosen category.</p></li>
<li><p><strong>Data Type:</strong> Users can switch between Original data or Change data. The Change data typically represents derived statistics such as growth rates or absolute changes, providing insights into how the selected variables evolve over time. This feature enriches the analysis by offering a comparative view of the raw data against its rate of change, catering to different analytical needs and preferences.</p></li>
<li><p><strong>Time Selection:</strong> Slider inputs for Start Year and End Year facilitate the specification of a time range for the analysis. Dropdowns for Start Quarter and End Quarter or Start Month and End Month provide more granular control over the selected time period.</p></li>
</ul>
<p><strong>Interactive Line Plot:</strong></p>
<p>The plot itself is designed for interactivity (using <strong><code>plotly</code></strong>), providing tooltips on hover for detailed insights into specific data points. The use of a line plot is ideal for visualizing time series data and observing trends over a selected period.</p>
</section>
</section>
<section id="distribution" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="distribution"><span class="header-section-number">3.3</span> Distribution</h3>
<section id="test-code-1" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="test-code-1"><span class="header-section-number">3.3.1</span> <strong>Test Code</strong></h4>
<p>We test Distribution Histogram in Index variable using <code>ggplot2</code> and <code>plotly</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the number of bins for the histogram</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>bins_count <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for the 'Index' column and add vertical lines for mean and median</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(month_data, <span class="fu">aes</span>(<span class="at">x =</span> Index)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> bins_count, <span class="at">fill =</span> <span class="st">"#6D9EC1"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">color =</span> <span class="st">"gold"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Index"</span>, <span class="at">x =</span> <span class="st">"Index"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot object to an interactive Plotly object</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotations for mean and median to the plot</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="st">"Mean"</span>,  <span class="co"># Text label for the mean</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(month_data<span class="sc">$</span>Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Position of the mean on x-axis</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.85</span>,  <span class="co"># Position of the text on the plot (relative to the plot area)</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">xref =</span> <span class="st">"x"</span>,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">showarrow =</span> <span class="cn">FALSE</span>,  <span class="co"># Do not show an arrow</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="dv">10</span>)  <span class="co"># Font settings</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="st">"Median"</span>,  <span class="co"># Text label for the median</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">median</span>(month_data<span class="sc">$</span>Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Position of the median on x-axis</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.70</span>,  <span class="co"># Position of the text on the plot (relative to the plot area)</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xref =</span> <span class="st">"x"</span>,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">showarrow =</span> <span class="cn">FALSE</span>,  <span class="co"># Do not show an arrow</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gold"</span>, <span class="at">size =</span> <span class="dv">10</span>)  <span class="co"># Font settings</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cda53c777d7390ec9699" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cda53c777d7390ec9699">{"x":{"data":[{"orientation":"v","width":[156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716,156.87118014285716],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1568.7118014285716,1725.5829815714287,1882.4541617142859,2039.325341857143,2196.1965220000002,2353.0677021428573,2509.9388822857145,2666.8100624285717,2823.6812425714288,2980.552422714286,3137.4236028571431,3294.2947830000003,3451.1659631428574,3608.0371432857146,3764.9083234285717],"y":[1,4,2,0,3,9,12,13,25,26,55,52,14,5,1],"text":["count:  1<br />Index: 1568.712","count:  4<br />Index: 1725.583","count:  2<br />Index: 1882.454","count:  0<br />Index: 2039.325","count:  3<br />Index: 2196.197","count:  9<br />Index: 2353.068","count: 12<br />Index: 2509.939","count: 13<br />Index: 2666.810","count: 25<br />Index: 2823.681","count: 26<br />Index: 2980.552","count: 55<br />Index: 3137.424","count: 52<br />Index: 3294.295","count: 14<br />Index: 3451.166","count:  5<br />Index: 3608.037","count:  1<br />Index: 3764.908"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(109,158,193,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037,3000.1465731036037],"y":[-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75],"text":"mean(Index, na.rm = TRUE): 3000.147","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(228,103,38,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003,3118.3439525000003],"y":[-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,-2.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75,57.75],"text":"median(Index, na.rm = TRUE): 3118.344","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,215,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Distribution of Index","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1372.6228262500001,3960.9972986071434],"tickmode":"array","ticktext":["1500","2000","2500","3000","3500"],"tickvals":[1500,2000,2500,3000,3500],"categoryorder":"array","categoryarray":["1500","2000","2500","3000","3500"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Index","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.75,57.75],"tickmode":"array","ticktext":["0","20","40"],"tickvals":[0,20,40],"categoryorder":"array","categoryarray":["0","20","40"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Frequency","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative","annotations":[{"text":"Mean","x":3000.1465731036037,"y":0.84999999999999998,"xref":"x","yref":"paper","showarrow":false,"font":{"color":"#E46726","size":10}},{"text":"Median","x":3118.3439525000003,"y":0.69999999999999996,"xref":"x","yref":"paper","showarrow":false,"font":{"color":"gold","size":10}}]},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"7b8032e34c39":{"x":{},"type":"bar"},"7b8022ea429":{"xintercept":{}},"7b808253df6":{"xintercept":{}}},"cur_data":"7b8032e34c39","visdat":{"7b8032e34c39":["function (y) ","x"],"7b8022ea429":["function (y) ","x"],"7b808253df6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="ui-design-1" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="ui-design-1"><span class="header-section-number">3.3.2</span> Ui Design</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/41a439b8d318d7c913208ecdb1f3955.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><strong>Filter Panel:</strong></p>
<ul>
<li><p><strong>Category and Variable Selection:</strong> Users begin by selecting a varialbe category from the Choose a category dropdown, followed by choosing a variable, within that category from the Choose a variable dropdown. This enables users to focus their analysis on specific variable, making the data analysis more targeted and specific.</p></li>
<li><p><strong>Year Range Selection:</strong> Users employ a slider input to select a specific range of years. The start and end years can be set by adjusting the slider, allowing users to concentrate on data from a specific period.</p></li>
<li><p><strong>Adjusting Number of Bins:</strong> A slider is provided to adjust the number of bins in the histogram, allowing users to view a rough or detailed distribution of data as needed. The number of bins in a histogram directly affects how users perceive data distribution. Being able to adjust the number of bins enables users to tailor the view to different characteristics of the data and analysis needs, thus gaining deeper insights.</p></li>
</ul>
<p><strong>Interactive Histogram:</strong></p>
<p>A histogram is generated based on the user-selected category and variable. If the PPI category is selected, the <strong><code>quarter_data</code></strong> is used; otherwise, <strong><code>month_data</code></strong> is used, supplemented with dashed lines indicating mean and median values. Visual markers for mean and median provide users with an intuitive sense of the datasets central tendencies, helping to identify the shape of the distribution and where data points are concentrated.</p>
</section>
</section>
<section id="autocorrelation" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="autocorrelation"><span class="header-section-number">3.4</span> <strong>Autocorrelation</strong></h3>
<section id="test-code-2" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="test-code-2"><span class="header-section-number">3.4.1</span> <strong>Test Code</strong></h4>
<p>We test the Autocorrelation Plot in Index variable using <code>ggplot2</code> , <code>dplyr</code> and <code>viridis</code> (for color) package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose colors</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>viridis_colors <span class="ot">&lt;-</span> viridis<span class="sc">::</span><span class="fu">viridis_pal</span>()(<span class="dv">5</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(quarter_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Year), <span class="at">y =</span> Index)) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"gold"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot and Mean of PR_All over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Index"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"#333333"</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-667bab48f8c1f9c4349b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-667bab48f8c1f9c4349b">{"x":{"data":[{"x":[1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19],"y":[2294.4783076923077,2292.1801612903228,2449.3755737704919,2479.0477419354838,2462.7893749999998,2782.2273015873016,3136.0154098360654,3478.4737096774193,3486.88671875,3600.3671428571429,3037.8962295081969,3119.4441269841268,2745.3136363636363,1818.915806451613,1674.2380327868852,2128.2663492063493,2551.4332812500002,2737.129375,2830.6747540983606,2866.7915873015872,2980.41359375,3183.6209374999999,3118.2409677419355,3124.5861290322582,2922.7429687499998,2723.0583870967744,2922.3038709677421,2876.9123809523808,3026.6700000000001,3064.3496825396824,3261.6748333333335,3299.2801587301587,3171.1021875000001,3160.9835937500002,3093.4756451612902,3258.5479032258063,3312.7484615384615,3281.8760317460319,3392.9980327868852,3421.6432258064515,3081.4914754098359,2928.6215625,2704.5619672131147,2810.19234375,2868.3085714285712,2863.1889062499999,3081.91126984127,3210.8488524590166,3265.9353968253968,3380.1482539682538,3496.0312903225808,3468.3017741935482,3234.1207936507935,3084.2531250000002,3202.3909836065573,3268.9270491803277,3221.9020312500002,3188.7264062499999,3004.3777777777777,2591.7473770491802,2552.0590476190482,2692.7724615384618,2997.4461290322579,3161.3432258064522,3117.8629687500002,3159.6789230769232,3307.4601612903225,3245.594262295082,3210.1498437499999,3182.3833333333332,3276.4972580645158,3241.0457377049179,3238.1042857142857,3123.0144444444445],"hoverinfo":"y","type":"box","fillcolor":"rgba(0,0,139,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"y":[2293.3292344913152,2543.3599980733193,3425.4357452801569,2680.3924498268934,2272.7667595608086,2965.3752181624868,2972.1571131552419,2972.5589836149511,3223.2601933283731,3236.6620104178974,3206.1885741257929,2811.5629471604216,3234.7109432734842,3320.6767457917308,3220.4866175717211,2710.2391659961168,3109.0828116664084,3236.3969001671844,3219.6654314820407],"text":["factor(Year): 2005<br />Index: 2293.329","factor(Year): 2006<br />Index: 2543.360","factor(Year): 2007<br />Index: 3425.436","factor(Year): 2008<br />Index: 2680.392","factor(Year): 2009<br />Index: 2272.767","factor(Year): 2010<br />Index: 2965.375","factor(Year): 2011<br />Index: 2972.157","factor(Year): 2012<br />Index: 2972.559","factor(Year): 2013<br />Index: 3223.260","factor(Year): 2014<br />Index: 3236.662","factor(Year): 2015<br />Index: 3206.189","factor(Year): 2016<br />Index: 2811.563","factor(Year): 2017<br />Index: 3234.711","factor(Year): 2018<br />Index: 3320.677","factor(Year): 2019<br />Index: 3220.487","factor(Year): 2020<br />Index: 2710.239","factor(Year): 2021<br />Index: 3109.083","factor(Year): 2022<br />Index: 3236.397","factor(Year): 2023<br />Index: 3219.665"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,215,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":50.138646741386466,"r":7.3059360730593621,"b":47.217425487570864,"l":57.451224574512253},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot and Mean of PR_All over Time","font":{"color":"rgba(51,51,51,1)","family":"","size":23.910336239103366},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,19.600000000000001],"tickmode":"array","ticktext":["2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023"],"tickvals":[1,2,3,4,5,6.0000000000000009,7,8,9,10,11,12,13,14.000000000000002,15,16,17,18,19],"categoryorder":"array","categoryarray":["2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.940224159402243},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1577.9315772833725,3696.6735983606559],"tickmode":"array","ticktext":["2000","2500","3000","3500"],"tickvals":[2000,2500,3000,3500],"categoryorder":"array","categoryarray":["2000","2500","3000","3500"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.940224159402243},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Index","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"7b8034e261a3":{"x":{},"y":{},"type":"box"},"7b809527260":{"x":{},"y":{}}},"cur_data":"7b8034e261a3","visdat":{"7b8034e261a3":["function (y) ","x"],"7b809527260":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="ui-design-2" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="ui-design-2"><span class="header-section-number">3.4.2</span> Ui Design</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">By year</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">By month</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">By quarter</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><img src="images/dbfff05b2586c38554dedc7c98c3bf4.png" class="img-fluid"></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><img src="images/540fc4170bbb9fe0f651f595dd74e32.png" class="img-fluid"></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p><img src="images/6483ab4104b3fd6ae158561ef9cd60d.png" class="img-fluid"></p>
</div>
</div>
</div>
<p><strong>Filter Panel:</strong></p>
<ul>
<li><p><strong>Variable Selection:</strong> The choice of variables is similar to Trend. Users can select between Original and Change data types, variables are also selected based on the chosen category.</p></li>
<li><p><strong>View Mode:</strong> Time-based data visualization requires an axis that accurately reflects the time increments of the data. This flexibility ensures that users can quickly interpret the timescale of the autocorrelation without confusion (by Year, Quarter, or Month)</p></li>
</ul>
<p><strong>Interactive Boxplot with Mean Over Time</strong></p>
<p>Generating a boxplot with an overlaying mean line, providing a visual summary of the distribution of values within each time period as well as the central tendency over time. The combination of a boxplot with a mean line is a powerful way to visualize variability and central tendency in data simultaneously. The x-axis is dynamic and changes based on whether the view mode is set to Year, Quarter, or Month.</p>
</section>
</section>
<section id="correlation" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="correlation"><span class="header-section-number">3.5</span> Correlation</h3>
<section id="test-code-3" class="level4" data-number="3.5.1">
<h4 data-number="3.5.1" class="anchored" data-anchor-id="test-code-3"><span class="header-section-number">3.5.1</span> <strong>Test Code</strong></h4>
<p>We test the Autocorrelation Plot in Index variable using <code>ggcorrplot</code> and <code>ggplot2</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PR_All"</span>, <span class="st">"PR_Landed"</span>, <span class="st">"PR_NL_ALL"</span>, <span class="st">"PR_NL_CCR"</span>, <span class="st">"PR_NL_RCR"</span>, <span class="st">"PR_NL_OCR"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Index"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the 'quarter_data' to include only the selected variables</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> quarter_data[variables]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(selected_data, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation plot using 'ggcorrplot'</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(corr_matrix, <span class="at">hc.order =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">lab_size =</span> <span class="fl">3.5</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>), </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>()) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="ui-design-3" class="level4" data-number="3.5.2">
<h4 data-number="3.5.2" class="anchored" data-anchor-id="ui-design-3"><span class="header-section-number">3.5.2</span> Ui Design</h4>
<p><strong>Filter Panel:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/3130b87a956db52080a98f538fbb796.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li><p><strong>Variable Selection:</strong> A structured selection interface is provided with checkboxes grouped by categories such as PPI, Materials, Index, and Financial. By default, all variables within each category are pre-selected. Users can select variables within these categories to include in the cross-correlation analysis. Grouping variables by category helps users navigate through a potentially large number of variables and allows for a more organized selection process. It also facilitates comparisons within and across different categories of data, which is essential for cross-correlation analysis.</p></li>
<li><p><strong>Select All/Deselect All:</strong> Select All and Deselect All buttons are included to provide a quick way to select or clear all checkboxes within each category. This functionality enhances the user experience by providing convenience and saving time, especially when dealing with large datasets where users might want to start with a broad analysis and then refine their selection.</p></li>
</ul>
<p><strong>Correlation Matrix Visualization:</strong></p>
<p>The aesthetics of the correlation matrix are enhanced with a color palette ranging from blue (negative correlation) to white (no correlation) to orange (positive correlation). The size of the plot is explicitly controlled to ensure it is appropriately displayed within the dashboard layout. Color coding makes it easier to distinguish between different levels of correlation at a glance. Controlling the size of the output plot ensures that the visualization remains clear and accessible, even on different devices or screen sizes.</p>
</section>
</section>
</section>
<section id="future-work" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="future-work"><span class="header-section-number">4</span> Future Work</h2>
<p>Following the completion of our ShinyApp models design phase, our next steps involve refining and integrating the model within the broader context of our group project. While the current iteration of the model meets the initial design and functionality requirements, continuous improvement and integration efforts are essential to enhance its utility, user experience, and analytical capabilities.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take Home Exercise 4: Prototyping Modules for Visual Analytics Shiny Application"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Cai Jingheng"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "Mar,1,2024"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Objectives**</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>In this take-home exercise, we are required to select one of the modules of our proposed Shiny application and complete the following tasks:</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To evaluate and determine the necessary R packages needed for our Shiny application are supported in R CRAN,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To prepare and test the specific R codes to ensure they can be run and return the correct output as expected,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To determine the parameters and outputs that will be exposed on the Shiny applications, and</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To select the appropriate Shiny UI components for exposing the parameters determined above.</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preparation</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Files</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/PPI_private_housing.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'PR_All'</span>, <span class="st">'PR_Landed'</span>, <span class="st">'PR_NL_ALL'</span>, <span class="st">'PR_NL_CCR'</span>, <span class="st">'PR_NL_RCR'</span>, <span class="st">'PR_NL_OCR'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Date) <span class="sc">%&gt;%</span> </span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year))</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>material_price <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Construction Materials prices.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Cement'</span>, <span class="st">'SteelBar'</span>, <span class="st">'Granite'</span>, <span class="st">'ConcretingSand'</span>, <span class="st">'ReadyMixConcrete'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>sti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Index FTSE Strait Times.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Index'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>tbillbond <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Treasury_Bill_Bond_ rates.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Bill1Yr'</span>, <span class="st">'Bond2Yr'</span>, <span class="st">'Bond5Yr'</span>, <span class="st">'Bond10Yr'</span>, <span class="st">'Bond15Yr'</span>, <span class="st">'Bond20Yr'</span>,<span class="st">'Bond30Yr'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Bond15Yr, <span class="sc">-</span>Bond20Yr, <span class="sc">-</span>Bond30Yr)</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>sora <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Singapore Overnight Rate Average SORA Daily.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Rate'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Wrangling</span></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>Data Wrangling - to compute change (for SORA and Bond/Bill rates) and percentage change (for the various indices and prices)</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a><span class="co"># PPI - percentage change computations</span></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>ppi_quarter <span class="ot">&lt;-</span> ppi <span class="sc">%&gt;%</span> </span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_All</span><span class="st">`</span> <span class="ot">=</span> (PR_All <span class="sc">-</span> <span class="fu">lag</span>(PR_All))<span class="sc">/</span><span class="fu">lag</span>(PR_All)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_Landed</span><span class="st">`</span> <span class="ot">=</span> (PR_Landed <span class="sc">-</span> <span class="fu">lag</span>(PR_Landed))<span class="sc">/</span><span class="fu">lag</span>(PR_Landed)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_ALL</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_ALL <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_ALL))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_ALL)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_CCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_CCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_CCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_CCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_RCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_RCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_RCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_RCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_OCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_OCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_OCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_OCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Month) <span class="sc">%&gt;%</span> </span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'Year'</span>,<span class="st">'Quarter'</span>,<span class="fu">everything</span>())</span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_month - percentage change computations</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a>material_price_month <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span> </span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date) <span class="sc">%&gt;%</span> </span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_quarter_avg - percentage change computations</span></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>material_price_quarter_avg <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span></span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month) <span class="sc">%&gt;%</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_month_avg - percentage change computations</span></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>sti_month_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_quarter_avg - percentage change computations</span></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a>sti_quarter_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span>         </span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_month - rate change computations</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a>tbillbond_month_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_quarter_avg - percentage change computations</span></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a>tbillbond_quarter_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_month - percentage change computations</span></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a>sora_month_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_quarter_avg - percentage change computations</span></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a>sora_quarter_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## Join Tables</span></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a><span class="co"># put all monthly data into 1 dataset</span></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> material_price_month <span class="sc">%&gt;%</span> </span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthLabel =</span> <span class="fu">paste0</span>(Month, <span class="st">'M'</span>, <span class="fu">as.character</span>(Year))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">'01-'</span>, Month, <span class="st">'-'</span>, Year), <span class="at">format=</span><span class="st">"%d-%m-%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, MonthLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Month)</span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a><span class="co"># put all quarter data into 1 dataset</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a>data_by_quarter <span class="ot">&lt;-</span> ppi_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(material_price_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">QuarterLabel =</span> <span class="fu">paste0</span>(Quarter, <span class="fu">as.character</span>(Year)))  <span class="sc">%&gt;%</span> </span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">paste0</span>(Year, <span class="st">'-'</span>, <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q1"</span>, <span class="st">"03"</span>, </span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q2"</span>, <span class="st">"06"</span>,</span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q3"</span>, <span class="st">"09"</span>, <span class="st">"12"</span>))), <span class="st">"-01"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Quarter)</span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save Dataset</span></span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_by_month, <span class="st">"data/data_by_month.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_by_quarter, <span class="st">"data/data_by_quarter.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Dataset</span></span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a>month_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/data_by_month.csv'</span>)</span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>quarter_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/data_by_quarter.csv'</span>)</span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a>First we check the variables of both tables:</span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(month_data)</span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quarter_data)</span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>We can see that there is no corresponding data for PPI in month_data, and secondly, there are a lot of variables. In order to make it easier for the user to choose, I have used the following code to divide the variables into four categories: PPI, Materials, Index and Financial. Providing a clear path of choices is essential for managing complex datasets, especially when dealing with multiple sources or categories. This approach reduces information overload, enabling users to perform focused analyses quickly.</span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a>categories_quarter <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a>  <span class="at">PPI =</span> <span class="fu">c</span>(<span class="st">"PR_All"</span>, <span class="st">"PR_Landed"</span>, <span class="st">"PR_NL_ALL"</span>, <span class="st">"PR_NL_CCR"</span>, <span class="st">"PR_NL_RCR"</span>, <span class="st">"PR_NL_OCR"</span>),</span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a>  <span class="at">Materials =</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>),</span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">"Index"</span>),</span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a>  <span class="at">Financial =</span>  <span class="fu">c</span>(<span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>categories_month <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a>  <span class="at">Materials =</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>),</span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">"Index"</span>),</span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a>  <span class="at">Financial =</span>  <span class="fu">c</span>(<span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a>In addition, both datasets count the variable change, so we deal with the data variable of change.</span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a>categories_changes_quarter <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(categories_quarter), <span class="cf">function</span>(category) {</span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">!=</span> <span class="st">"Financial"</span>) {</span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"%Change_"</span>, categories_quarter[[category]])</span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Change_"</span>, categories_quarter[[category]])</span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>categories_changes_month <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(categories_month), <span class="cf">function</span>(category) {</span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">!=</span> <span class="st">"Financial"</span>) {</span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"%Change_"</span>, categories_month[[category]])</span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Change_"</span>, categories_month[[category]])</span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a>categories_changes_quarter <span class="ot">&lt;-</span> <span class="fu">setNames</span>(categories_changes_quarter, <span class="fu">names</span>(categories_quarter))</span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>categories_changes_month <span class="ot">&lt;-</span> <span class="fu">setNames</span>(categories_changes_month, <span class="fu">names</span>(categories_month))</span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a>These code snippets take two lists categorized by quarters and months, respectively, iterate over each category within these lists, and create new lists where the variables are renamed to indicate changes (either percentage or absolute changes).</span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>Next,Pre-processing of quarterly and monthly data.</span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a>quarter_data<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(quarter_data<span class="sc">$</span>QuarterLabel, <span class="dv">3</span>, <span class="dv">6</span>))</span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a>quarter_data<span class="sc">$</span>Quarter <span class="ot">&lt;-</span> <span class="fu">substr</span>(quarter_data<span class="sc">$</span>QuarterLabel, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a>month_data<span class="sc">$</span>Year <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(month_data<span class="sc">$</span>Date)</span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a>month_data<span class="sc">$</span>Month <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">month</span>(month_data<span class="sc">$</span>Date)</span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Design for EDA</span></span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a>In this exercise, I will be responsible for the EDA part of our group project shinyapp, here is my <span class="co">[</span><span class="ot">Shinyapp Prototype</span><span class="co">](https://isss608-cjh.shinyapps.io/ProjectEDA/)</span>. <span class="sc">\-</span>-https://isss608-cjh.shinyapps.io/ProjectEDA/</span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overview</span></span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/2efc099809aabed84023ab172898874.png)</span></span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a>This UI is designed for a Shiny app, structured using **`dashboardPage`** from the **`shinydashboard`** package, aiming to provide a user-friendly interface for Exploratory Data Analysis (EDA).</span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>The sidebar is organized into main analysis types - Trend, Distribution, Autocorrelation, and Crosscorrelation - to guide the user through the different facets of EDA. Users can click on these to switch between different analyses.</span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trend</span></span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Test Code**</span></span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a>We test the Trend Line Plot in "Index" variable using <span class="in">`plotly`</span> package</span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(month_data, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> .data[[<span class="st">"Index"</span>]])) <span class="sc">+</span></span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#3366CC"</span>) <span class="sc">+</span> </span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Trend of"</span>, <span class="at">y =</span> <span class="st">"Index"</span>, <span class="st">"over Time"</span>), <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Index"</span>, </span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.size =</span> <span class="dv">18</span>, <span class="at">title.color =</span> <span class="st">"#333333"</span>) <span class="sc">+</span> </span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>), </span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">size =</span> <span class="dv">14</span>), </span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#D3D3D3"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>), <span class="co"># </span></span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#F8F8F8"</span>) </span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p)</span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ui Design</span></span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/e8a04a001a900c202d66b6eaadc15ba.png)</span>{fig-align="center"}</span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a>**Filter Panel:**</span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a>Within the "Trend" analysis tab, the sidebar serves as a filter panel where users can customize the data they wish to analyze by:</span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**View by:** Allows selection between 'Quarter' and 'Month', catering to datasets with different temporal resolutions. (When selecting Month, PPI cannot be selected due to missing data)</span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Choose a category:** Enables the selection of a data category ('PPI', 'Materials', 'Index', 'Financial'), which represents different variable categories.</span>
<span id="cb22-409"><a href="#cb22-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-410"><a href="#cb22-410" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Choose a variable:** Offers a dropdown to select specific variables within the chosen category.</span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Data Type:** Users can switch between 'Original' data or 'Change' data. The "Change" data typically represents derived statistics such as growth rates or absolute changes, providing insights into how the selected variables evolve over time. This feature enriches the analysis by offering a comparative view of the raw data against its rate of change, catering to different analytical needs and preferences.</span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Time Selection:** Slider inputs for 'Start Year' and 'End Year' facilitate the specification of a time range for the analysis. Dropdowns for 'Start Quarter' and 'End Quarter' or 'Start Month' and 'End Month' provide more granular control over the selected time period.</span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a>**Interactive Line Plot:**</span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a>The plot itself is designed for interactivity (using **`plotly`**), providing tooltips on hover for detailed insights into specific data points. The use of a line plot is ideal for visualizing time series data and observing trends over a selected period.</span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribution</span></span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Test Code**</span></span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a>We test Distribution Histogram in "Index" variable using <span class="in">`ggplot2`</span> and <span class="in">`plotly`</span> package.</span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the number of bins for the histogram</span></span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a>bins_count <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for the 'Index' column and add vertical lines for mean and median</span></span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(month_data, <span class="fu">aes</span>(<span class="at">x =</span> Index)) <span class="sc">+</span></span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> bins_count, <span class="at">fill =</span> <span class="st">"#6D9EC1"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">color =</span> <span class="st">"gold"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Index"</span>, <span class="at">x =</span> <span class="st">"Index"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot object to an interactive Plotly object</span></span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot)</span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotations for mean and median to the plot</span></span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="st">"Mean"</span>,  <span class="co"># Text label for the mean</span></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(month_data<span class="sc">$</span>Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Position of the mean on x-axis</span></span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.85</span>,  <span class="co"># Position of the text on the plot (relative to the plot area)</span></span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">xref =</span> <span class="st">"x"</span>,</span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">showarrow =</span> <span class="cn">FALSE</span>,  <span class="co"># Do not show an arrow</span></span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="dv">10</span>)  <span class="co"># Font settings</span></span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="st">"Median"</span>,  <span class="co"># Text label for the median</span></span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">median</span>(month_data<span class="sc">$</span>Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Position of the median on x-axis</span></span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.70</span>,  <span class="co"># Position of the text on the plot (relative to the plot area)</span></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">xref =</span> <span class="st">"x"</span>,</span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">showarrow =</span> <span class="cn">FALSE</span>,  <span class="co"># Do not show an arrow</span></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gold"</span>, <span class="at">size =</span> <span class="dv">10</span>)  <span class="co"># Font settings</span></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ui Design</span></span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/41a439b8d318d7c913208ecdb1f3955.png)</span>{fig-align="center"}</span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>**Filter Panel:**</span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Category and Variable Selection:** Users begin by selecting a varialbe category from the 'Choose a category' dropdown, followed by choosing a variable, within that category from the 'Choose a variable' dropdown. This enables users to focus their analysis on specific variable, making the data analysis more targeted and specific.</span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Year Range Selection:** Users employ a slider input to select a specific range of years. The start and end years can be set by adjusting the slider, allowing users to concentrate on data from a specific period.</span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Adjusting Number of Bins:** A slider is provided to adjust the number of bins in the histogram, allowing users to view a rough or detailed distribution of data as needed. The number of bins in a histogram directly affects how users perceive data distribution. Being able to adjust the number of bins enables users to tailor the view to different characteristics of the data and analysis needs, thus gaining deeper insights.</span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a>**Interactive Histogram:**</span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a>A histogram is generated based on the user-selected category and variable. If the 'PPI' category is selected, the **`quarter_data`** is used; otherwise, **`month_data`** is used, supplemented with dashed lines indicating mean and median values. Visual markers for mean and median provide users with an intuitive sense of the dataset's central tendencies, helping to identify the shape of the distribution and where data points are concentrated.</span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Autocorrelation**</span></span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Test Code**</span></span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a>We test the Autocorrelation Plot in "Index" variable using <span class="in">`ggplot2`</span> , <span class="in">`dplyr`</span> and <span class="in">`viridis`</span> (for color) package.</span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose colors</span></span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a>viridis_colors <span class="ot">&lt;-</span> viridis<span class="sc">::</span><span class="fu">viridis_pal</span>()(<span class="dv">5</span>)</span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(quarter_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Year), <span class="at">y =</span> Index)) <span class="sc">+</span></span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"gold"</span>) <span class="sc">+</span></span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot and Mean of PR_All over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Index"</span>) <span class="sc">+</span></span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"#333333"</span>),</span>
<span id="cb22-514"><a href="#cb22-514" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb22-515"><a href="#cb22-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplotly</span>(p)</span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ui Design</span></span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a><span class="fu">## By year</span></span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/dbfff05b2586c38554dedc7c98c3bf4.png)</span></span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a><span class="fu">## By month</span></span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/540fc4170bbb9fe0f651f595dd74e32.png)</span></span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## By quarter</span></span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/6483ab4104b3fd6ae158561ef9cd60d.png)</span></span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a>**Filter Panel:**</span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Variable Selection:** The choice of variables is similar to Trend. Users can select between "Original" and "Change" data types, variables are also selected based on the chosen category.</span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-542"><a href="#cb22-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**View Mode:** Time-based data visualization requires an axis that accurately reflects the time increments of the data. This flexibility ensures that users can quickly interpret the timescale of the autocorrelation without confusion (by Year, Quarter, or Month)</span>
<span id="cb22-543"><a href="#cb22-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a>**Interactive Boxplot with Mean Over Time**</span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a>Generating a boxplot with an overlaying mean line, providing a visual summary of the distribution of values within each time period as well as the central tendency over time. The combination of a boxplot with a mean line is a powerful way to visualize variability and central tendency in data simultaneously. The x-axis is dynamic and changes based on whether the view mode is set to Year, Quarter, or Month.</span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation</span></span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Test Code**</span></span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a>We test the Autocorrelation Plot in "Index" variable using <span class="in">`ggcorrplot`</span> and <span class="in">`ggplot2`</span> package.</span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=8, fig.height=8}</span></span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-558"><a href="#cb22-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PR_All"</span>, <span class="st">"PR_Landed"</span>, <span class="st">"PR_NL_ALL"</span>, <span class="st">"PR_NL_CCR"</span>, <span class="st">"PR_NL_RCR"</span>, <span class="st">"PR_NL_OCR"</span>,</span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>,</span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Index"</span>,</span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span></span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the 'quarter_data' to include only the selected variables</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> quarter_data[variables]</span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(selected_data, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation plot using 'ggcorrplot'</span></span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(corr_matrix, <span class="at">hc.order =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb22-575"><a href="#cb22-575" aria-hidden="true" tabindex="-1"></a>                <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">lab_size =</span> <span class="fl">3.5</span>,</span>
<span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a>                <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>), </span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a>                <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>()) <span class="sc">+</span></span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-585"><a href="#cb22-585" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ui Design</span></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a>**Filter Panel:**</span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/3130b87a956db52080a98f538fbb796.png)</span>{fig-align="center"}</span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Variable Selection:** A structured selection interface is provided with checkboxes grouped by categories such as "PPI," "Materials," "Index," and "Financial." By default, all variables within each category are pre-selected. Users can select variables within these categories to include in the cross-correlation analysis. Grouping variables by category helps users navigate through a potentially large number of variables and allows for a more organized selection process. It also facilitates comparisons within and across different categories of data, which is essential for cross-correlation analysis.</span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Select All/Deselect All:** Select All" and "Deselect All" buttons are included to provide a quick way to select or clear all checkboxes within each category. This functionality enhances the user experience by providing convenience and saving time, especially when dealing with large datasets where users might want to start with a broad analysis and then refine their selection.</span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a>**Correlation Matrix Visualization:**</span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-597"><a href="#cb22-597" aria-hidden="true" tabindex="-1"></a>The aesthetics of the correlation matrix are enhanced with a color palette ranging from blue (negative correlation) to white (no correlation) to orange (positive correlation). The size of the plot is explicitly controlled to ensure it is appropriately displayed within the dashboard layout. Color coding makes it easier to distinguish between different levels of correlation at a glance. Controlling the size of the output plot ensures that the visualization remains clear and accessible, even on different devices or screen sizes.</span>
<span id="cb22-598"><a href="#cb22-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-599"><a href="#cb22-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## Future Work</span></span>
<span id="cb22-600"><a href="#cb22-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-601"><a href="#cb22-601" aria-hidden="true" tabindex="-1"></a>Following the completion of our ShinyApp model's design phase, our next steps involve refining and integrating the model within the broader context of our group project. While the current iteration of the model meets the initial design and functionality requirements, continuous improvement and integration efforts are essential to enhance its utility, user experience, and analytical capabilities.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>